(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),o=n.n(c),i=n(12),l=n(9),u=n(25),s=n(44),d=n(60),f=n(46),m=n.n(f),y={flex:1,display:"flex",flexDirection:"row",alignItems:"center",padding:"20px",paddingLeft:"20px",paddingRight:"20px",borderWidth:2,borderRadius:4,borderColor:"black",borderStyle:"solid",backgroundColor:"#e7e7e7",color:"black",outline:"none",justifyContent:"space-around",fontSize:"18px"},p={backgroundColor:"#3a3a3a",color:"white"},b={borderColor:"white"},h={borderColor:"white",borderStyle:"solid"};var v=function(e){var t=e.addLayersToState,n=e.layers,c=Object(a.useCallback)((function(e){var n,a=[],r=Object(s.a)(e);try{var c=function(){var e=n.value,t=new Promise((function(t){var n=new FileReader;n.readAsText(e),n.onload=function(){return t(JSON.parse(n.result))}}));a.push(t)};for(r.s();!(n=r.n()).done;)c()}catch(o){r.e(o)}finally{r.f()}Promise.all(a).then((function(e){t(e,"upload")}))}),[n]),o=Object(d.a)({accept:".json",onDrop:c}),l=o.getRootProps,u=o.getInputProps,f=o.isDragActive,v=o.isDragAccept,E=o.isDragReject,g=Object(a.useMemo)((function(){return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},y),f?p:{}),v?b:{}),E?h:{})}),[f,E,v]);return r.a.createElement("div",l({style:g}),r.a.createElement("input",u()),r.a.createElement("text",null,"Upload Layers"),r.a.createElement(m.a,null))},E=n(123),g=n(124),j=n(119),O=n(120),C=n(121),S=n(122),L=function(e){var t=e.layers,n=e.removeLayerFromState,a=e.selectedLayersIndices,c=e.handleSelectedChange,o=e.handleMetaChange;return console.log(a),r.a.createElement("div",null,t&&t.map((function(e){return r.a.createElement("div",{key:e.id,className:-1===a.indexOf(e.id)?"layer-item":"layer-item-selected"},r.a.createElement(g.a,{disableGutters:!0,onClick:function(){c(e.id)}},e.name),"none"!==e.visibility?r.a.createElement(j.a,{onClick:function(){return o(e.id,"none")}}):r.a.createElement(O.a,{onClick:function(){return o(e.id,"visible")}}),r.a.createElement(C.a,null),r.a.createElement(S.a,{onClick:function(){return n(e.id)}}))})))},k=n(53),x=n.n(k),w=n(51),M=n.n(w),F=n(29),I=n.n(F),R=n(52),G=n.n(R),T=n(28),D=n.n(T),N="https://tba4251-api.herokuapp.com/";function J(e){var t=[];return e.forEach((function(e){t=[].concat(Object(l.a)(e.features),Object(l.a)(t))})),{type:"FeatureCollection",features:t}}function P(e,t){var n=J(t);return n.value=10,function(){D.a.post(N+"/api/buffer",n).then((function(t){e([t.data],"buffer")})).catch((function(e){}))}}function A(e,t){return function(){var n=J(t);D.a.post(N+"/api/union",n).then((function(t){e([t.data],"union")})).catch((function(e){}))}}function z(e,t){return function(){var n=J(t);D.a.post(N+"/api/intersection",n).then((function(t){e([t.data],"intersection")})).catch((function(e){}))}}var U=function(e){var t=e.children;return r.a.createElement("div",{className:"headLine"},t)},W=function(e){var t=e.children;return r.a.createElement("div",{className:"operation"},t)},B=function(e){var t=e.addLayersToState,n=e.removeLayersFromState,a=e.removeLayerFromState,c=e.layers,o=e.selectedLayersIndices,i=e.handleSelectedChange,l=e.handleMetaChange,u=c.filter((function(e){return-1!==o.indexOf(e.id)}));return r.a.createElement("div",{className:"sidebar"},r.a.createElement(E.a,{disablePadding:!0},r.a.createElement(U,null,r.a.createElement(g.a,{disableGutters:!0},"Operations"),r.a.createElement(M.a,null)),r.a.createElement(W,null,r.a.createElement(g.a,{disableGutters:!0,onClick:P(t,u)},"Buffer"),r.a.createElement(I.a,null)),r.a.createElement(W,null,r.a.createElement(g.a,{disableGutters:!0,onClick:A(t,u)},"Union"),r.a.createElement(I.a,null)),r.a.createElement(W,null,r.a.createElement(g.a,{disableGutters:!0,onClick:z(t,u)},"Intersection"),r.a.createElement(I.a,null)),r.a.createElement(W,null,r.a.createElement(g.a,{disableGutters:!0,onClick:n},"Remove layers"),r.a.createElement(G.a,null)),r.a.createElement(g.a,{disableGutters:!0},r.a.createElement(v,{accept:"*.json",addLayersToState:t,layers:c})),r.a.createElement(U,null,r.a.createElement(g.a,{disableGutters:!0},"Layers"),r.a.createElement(x.a,null)),r.a.createElement(L,{selectedLayersIndices:o,layers:c,removeLayerFromState:a,handleSelectedChange:i,handleMetaChange:l})))},Y=n(32),_=n.n(Y),q=n(59);n(100);_.a.accessToken="pk.eyJ1IjoidG9yc3RlaW4iLCJhIjoiY2s3YWJkdzk3MDU1bjNncnd0dWExN292YiJ9.te0K0gwI11dUd2qZs6FQ0g";var K=function(e){var t=e.layers,n=e.handleSelectedChange,c=e.addLayersToState,o=Object(a.useState)(null),i=Object(u.a)(o,2),l=i[0],s=i[1],d=Object(a.useRef)(null),f=function(e){e.forEach((function(e){l.addSource(e.id,{type:"geojson",data:e}),l.addLayer({id:e.id,type:"fill",source:e.id,layout:{visibility:"visible"},paint:{"fill-color":e.color,"fill-opacity":.7}})}))},m=function(e){e.forEach((function(e){l.removeLayer(e),l.removeSource(e)}))},y=function(e){return e.getStyle().layers.filter((function(e){return"composite"!==e.source&&"background"!==e.type&&"mapbox-gl-draw-cold"!==e.source&&"mapbox-gl-draw-hot"!==e.source})).map((function(e){return e.id}))},p=function(e){e.forEach((function(e){l.getLayoutProperty(e.id,"visibility")!==e.visibility&&l.setLayoutProperty(e.id,"visibility",e.visibility)}))};return Object(a.useEffect)((function(){l||function(e,t){var a=new _.a.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v11",center:[10.38,63.43],zoom:13}),r=new q.a({displayControlsDefault:!1,controls:{point:!0,line_string:!0,polygon:!0}});a.addControl(r,"top-right"),a.on("draw.create",(function(e){var t=r.getAll();c([t],"drawTool"),r.deleteAll()})),a.on("load",(function(){e(a),a.resize()})),a.on("click",(function(e){console.log(e);var t=a.queryRenderedFeatures(e.point,{layers:y(a)});t.length&&n(t.map((function(e){return e.layer.id}))[0])}))}(s,d)}),[l]),Object(a.useEffect)((function(){console.log("Map","Layers handled"),l&&function(e,t){var n=y(t),a=n.filter((function(t){return-1===e.map((function(e){return e.id})).indexOf(t)})),r=e.filter((function(e){return-1===n.indexOf(e.id)}));r[0]&&f(r),a[0]&&m(a),p(e)}(t,l)}),[t]),r.a.createElement("div",{ref:function(e){return d.current=e},className:"mapContainer"})};var Q=function(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),c=n[0],o=n[1],s=Object(a.useState)([]),d=Object(u.a)(s,2),f=d[0],m=d[1],y=Object(a.useRef)(f),p=function(e){return function(t,n){t.forEach((function(e){e.id=n+"_"+Math.random().toString(36).slice(2),e.name=n+"_"+Math.random().toString(36).slice(2),e.color=function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}()})),e((function(e){return[].concat(Object(l.a)(e),Object(l.a)(t))}))}},b=function(){return function(e){console.log(e),-1===y.current.indexOf(e)?(y.current=[].concat(Object(l.a)(y.current),[e]),console.log(y.current),m(y.current)):(y.current=y.current.filter((function(t){return t!==e})),m(y.current))}};return r.a.createElement("div",null,r.a.createElement(B,{addLayersToState:p(o),removeLayersFromState:function(e){return function(){m([]),e([]),y.current=[]}}(o),removeLayerFromState:function(e,t){return function(n){var a=t.filter((function(e){return e.id!==n})),r=y.current.filter((function(e){return e!==n}));m(r),y.current=r,e(a)}}(o,c),layers:c,selectedLayersIndices:f,handleSelectedChange:b(),handleMetaChange:function(e){return function(t,n){e((function(e){return e.map((function(e){return e.id===t?Object(i.a)(Object(i.a)({},e),{},{visibility:n}):e}))}))}}(o)}),r.a.createElement(K,{layers:c,handleSelectedChange:b(),addLayersToState:p(o)}))};o.a.render(r.a.createElement(Q,null),document.getElementById("app"))},62:function(e,t,n){e.exports=n(101)}},[[62,1,2]]]);
//# sourceMappingURL=main.e7925924.chunk.js.map